# LLVM Feature Extraction for Binary Vulnerability Analysis

This repository contains code for the preprocessing stage of a research paper titled [Deep-Learning-Based Vulnerability Detection in Binary Executables](https://doi.org/10.1007/978-3-031-30122-3_28) which focuses on deep-learning based vulnerability detection using LLVM Intermediate Representation.

The preprocessing steps implemented in this codebase are based on the [NIST Software Assurance Reference Dataset (SARD)](https://samate.nist.gov/SARD/) [Juliet Test Suite C/C++ 1.3](https://samate.nist.gov/SARD/test-suites/112), a widely recognized benchmark for evaluating software vulnerability detection tools. Additionally, a compilation step is performed beforehand using the unofficial [Juliet Test Suite Build System](https://github.com/arichardson/juliet-test-suite-c).

The following image provides a high-level representation of the different preprocessing stages carried out in the code provided.

![LLVMPreprocessingOverview](https://github.com/dobinder/LLVM-Feature-Extraction-for-Binary-Vulnerability-Analysis/assets/50400376/3670ec52-252c-4585-919c-e6224ccfb89a)

# Usage

To replicate the preprocessing, the following steps are required:
1. Download and build all Juliet Test Cases as described in [Juliet Test Suite Build System](https://github.com/arichardson/juliet-test-suite-c).
    1. Compiles each test case into individual binaries
2. Install [RetDec](https://github.com/avast/retdec)
3. Run CreateLLVM.ipynb (may require to change file paths to RetDec and Juliet Dataset)
    1. Decompiles each test case binary, creating the LLVM files used for our analysis
4. Run CreateDataset.ipynb (may require to change the file path to the Juliet Dataset (now including the decompiled output))
    1. Processes each LLVM file using the provided llvmParser
    2. Creates a dictionary for each processed function of interest (stored using pickle to lexified_good_funtions.pkl ahd lexified_bad_funtions.pkl)
    3. Performs test case selection
    4. Performs Word2Vec encoding
    5. Stores final dataset into features.pkl and labels.pkl
  

# Citation

If you use this code in your research or find it helpful, we kindly request that you cite the following paper:

```
Schaad, A., Binder, D. (2023). Deep-Learning-Based Vulnerability Detection in Binary Executables. In: Jourdan, GV., Mounier, L., Adams, C., Sèdes, F., Garcia-Alfaro, J. (eds) Foundations and Practice of Security. FPS 2022. Lecture Notes in Computer Science, vol 13877. Springer, Cham. https://doi.org/10.1007/978-3-031-30122-3_28
```

Here is a BibTeX entry for your convenience:

```
@InProceedings{10.1007/978-3-031-30122-3_28,
	author="Schaad, Andreas
	and Binder, Dominik",
	title="Deep-Learning-Based Vulnerability Detection in Binary Executables",
	booktitle="Foundations and Practice of Security",
	year="2023",
	publisher="Springer Nature Switzerland",
	pages="453--460",
	isbn="978-3-031-30122-3",
  doi="10.1007/978-3-031-30122-3_28"
}
```
  
# License

This project is licensed under the GNU GENERAL PUBLIC LICENSE. Please see the LICENSE file for more details.
